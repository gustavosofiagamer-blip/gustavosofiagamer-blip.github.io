<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pega-Pega das Bolas</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #111;
}
canvas { display: block; }
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const RAIO = 14;
const TEMPO_FUGA = 10 * 60; // 10 segundos
const cores = ["yellow", "red", "dodgerblue", "lime"];

let pegadora, fugitiva;
let tempo, estado, confetes;

// ===== INICIAR =====
function iniciarJogo() {
  let escolhidas = [...cores].sort(() => Math.random() - 0.5).slice(0, 2);

  pegadora = criarBola(escolhidas[0]);
  fugitiva = criarBola(escolhidas[1]);

  tempo = TEMPO_FUGA;
  estado = "jogando";
  confetes = [];
}

function criarBola(cor) {
  return {
    cor,
    x: Math.random() * (canvas.width - RAIO * 2) + RAIO,
    y: Math.random() * (canvas.height - RAIO * 2) + RAIO,
    vx: 0,
    vy: 0
  };
}

function manterNaTela(b) {
  b.x = Math.max(RAIO, Math.min(canvas.width - RAIO, b.x)));
  b.y = Math.max(RAIO, Math.min(canvas.height - RAIO, b.y)));
}

function criarConfetes(cor) {
  for (let i = 0; i < 120; i++) {
    confetes.push({
      x: canvas.width / 2,
      y: canvas.height / 2,
      dx: (Math.random() - 0.5) * 10,
      dy: (Math.random() - 0.5) * 10,
      vida: 90,
      cor
    });
  }
}

iniciarJogo();

// ===== LOOP =====
function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // TIMER GIGANTE ABSURDO (FUNDO)
  const tamanhoTimer = Math.min(canvas.width, canvas.height) * 0.6;
  ctx.fillStyle = "#444";
  ctx.font = `900 ${tamanhoTimer}px Arial`;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(Math.ceil(tempo / 60), canvas.width / 2, canvas.height / 2);

  if (estado === "jogando") {
    tempo--;

    // pegadora persegue
    let angP = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    pegadora.vx = Math.cos(angP) * 3;
    pegadora.vy = Math.sin(angP) * 3;

    // fugitiva foge
    let angF = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    fugitiva.vx = Math.cos(angF) * 2.2;
    fugitiva.vy = Math.sin(angF) * 2.2;

    [pegadora, fugitiva].forEach(b => {
      b.x += b.vx;
      b.y += b.vy;
      b.x = Math.max(RAIO, Math.min(canvas.width - RAIO, b.x));
      b.y = Math.max(RAIO, Math.min(canvas.height - RAIO, b.y));
    });

    // colisão
    let d = Math.hypot(pegadora.x - fugitiva.x, pegadora.y - fugitiva.y);
    if (d < RAIO * 2) {
      criarConfetes(pegadora.cor);
      estado = "fim";
    }

    // tempo acabou
    if (tempo <= 0) {
      criarConfetes(fugitiva.cor);
      estado = "fim";
    }
  } else {
    // reinício automático
    if (confetes.length === 0) iniciarJogo();
  }

  // bolas por cima do timer
  [pegadora, fugitiva].forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, RAIO, 0, Math.PI * 2);
    ctx.fillStyle = b.cor;
    ctx.fill();
  });

  // confetes
  confetes.forEach((c,i) => {
    c.x += c.dx;
    c.y += c.dy;
    c.dy += 0.25;
    c.vida--;
    ctx.fillStyle = c.cor;
    ctx.fillRect(c.x, c.y, 4, 4);
    if (c.vida <= 0) confetes.splice(i,1);
  });

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
